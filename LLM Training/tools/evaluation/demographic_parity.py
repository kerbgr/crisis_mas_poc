"""
Extracted from LLM Training Methodology.
Auto-generated by extract_code_from_methodology.py
"""

def demographic_parity(predictions_group_a, predictions_group_b):
    """
    Test if positive outcome rate is similar across groups.

    Args:
        predictions_group_a: List of quality scores for group A (e.g., Athens scenarios)
        predictions_group_b: List of quality scores for group B (e.g., rural scenarios)

    Returns:
        parity_ratio: Ratio of positive rates (should be close to 1.0)
    """
    import numpy as np

    # Define "positive outcome" as quality score >= 4/5
    positive_rate_a = np.mean(np.array(predictions_group_a) >= 4.0)
    positive_rate_b = np.mean(np.array(predictions_group_b) >= 4.0)

    # Calculate parity ratio (smaller / larger)
    parity_ratio = min(positive_rate_a, positive_rate_b) / max(positive_rate_a, positive_rate_b)

    print(f"Group A positive rate: {positive_rate_a:.2%}")
    print(f"Group B positive rate: {positive_rate_b:.2%}")
    print(f"Demographic parity ratio: {parity_ratio:.3f}")

    if parity_ratio >= 0.90:
        print("✅ Fair - similar quality across groups")
    elif parity_ratio >= 0.80:
        print("⚠️  Moderate bias detected")
    else:
        print("❌ Significant bias - model favors one group")

    return parity_ratio

# Target: Parity ratio > 0.90 (less than 10% difference between groups)
