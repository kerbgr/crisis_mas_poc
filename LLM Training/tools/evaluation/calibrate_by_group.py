"""
Extracted from LLM Training Methodology.
Auto-generated by extract_code_from_methodology.py
"""

def calibrate_by_group(model, validation_data):
    """
    Apply group-specific calibration to equalize performance.
    """
    groups = ["urban", "rural", "island"]
    calibration_params = {}

    for group in groups:
        group_data = [d for d in validation_data if d["location_type"] == group]

        # Find optimal temperature for this group
        optimal_temp = find_optimal_temperature_group(model, group_data)
        calibration_params[group] = optimal_temp

    return calibration_params

def apply_group_calibration(model_output, location_type, calibration_params):
    """Apply group-specific temperature scaling."""
    temp = calibration_params.get(location_type, 1.0)
    return softmax(model_output / temp)
