"""
Extracted from LLM Training Methodology.
Auto-generated by extract_code_from_methodology.py
"""

def rebalance_training_data(data, protected_attribute="location"):
    """
    Ensure balanced representation across groups.

    Example: If 80% of examples are Athens-based, undersample Athens
    or oversample rural examples to achieve 50-50 balance.
    """
    from collections import Counter

    counts = Counter(data[protected_attribute])
    target_count = max(counts.values())

    balanced_data = []
    for group in counts.keys():
        group_data = [d for d in data if d[protected_attribute] == group]

        # Oversample minority groups
        while len(group_data) < target_count:
            group_data.append(random.choice(group_data))

        balanced_data.extend(group_data)

    return balanced_data
